<div
    class="absolute inset-0 min-w-0 text-center overflow-auto print:overflow-visible"
    cdkScrollable>
    <!-- Main -->
    <div class="inline-block p-6 sm:p-0 text-left print:p-0">
        <!-- Report -->
        <div
            class="w-240 p-16 rounded-2xl shadow bg-card print:w-auto print:rounded-none print:shadow-none print:bg-transparent">
            <!-- Header -->
            <div class="bg-teal-700 text-white py-4 text-center">
                <h1 class="text-2xl font-bold">REPORTE MÉDICO</h1>
            </div>

            <!-- Patient Information -->
            <div class="flex justify-between mt-6 px-6">
                <div class="text-left">
                    <p><strong>DNI:</strong> {{ patient.dni }}</p>
                    <p><strong>Edad:</strong> {{ patient.age }} años</p>
                    <p><strong>Género:</strong> {{ patient.gender }}</p>
                    <p><strong>Teléfono:</strong> {{ patient.phone }}</p>
                    <p><strong>Paciente:</strong> {{ patient.name }}</p>
                </div>
                <div class="text-right">
                    <p><strong>Correo:</strong> {{ patient.email }}</p>
                    <p><strong>Fecha del reporte:</strong> {{ reportDate }}</p>
                </div>
            </div>

            <!-- Diagnosis -->
            <div class="mt-8 px-6">
                <div class="text-center font-bold bg-gray-100 py-2 border-b">
                    {{ diagnosis.title }}
                </div>
                <div class="bg-gray-50 py-6 px-4 rounded-md border mt-2">
                    {{ diagnosis.description }}
                </div>
            </div>

            <!-- Detailed Description -->
            <div class="mt-6 px-6">
                <div class="text-center font-bold bg-gray-100 py-2 border-b">
                    DETALLES DEL DIAGNÓSTICO
                </div>
                <div class="bg-gray-50 py-6 px-4 rounded-md border mt-2 whitespace-pre-line">
                    {{ diagnosis.details }}
                </div>
            </div>

            <!-- Anomalies -->
            <div class="mt-6 px-6">
                <div class="text-center font-bold bg-gray-100 py-2 border-b">
                    ANOMALÍAS DETECTADAS
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
                    <div
                        *ngFor="let anomaly of diagnosis.anomalies"
                        class="flex flex-col items-center border rounded-md p-4 bg-gray-50">
                        <img
                            [src]="anomaly.image"
                            alt="{{ anomaly.name }}"
                            class="w-32 h-32 object-cover rounded-md mb-2" />
                        <p>
                            <strong>{{ anomaly.name }}</strong>
                        </p>
                        <p><em>Ubicación:</em> {{ anomaly.location }}</p>
                        <p><em>Severidad:</em> {{ anomaly.severity }}</p>
                    </div>
                </div>
            </div>

            <!-- Capsule Journey -->
            <div class="mt-6 px-6">
                <div class="text-center font-bold bg-gray-100 py-2 border-b">
                    RESUMEN DEL RECORRIDO DE LA CÁPSULA
                </div>
                <div class="bg-gray-50 py-6 px-4 rounded-md border mt-2">
                    <p><strong>Fecha de inicio:</strong> {{ capsuleJourney.startDate }}</p>
                    <p><strong>Imágenes capturadas:</strong> {{ capsuleJourney.capturedImages }}</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
                        <div
                            *ngFor="let highlight of capsuleJourney.highlights"
                            class="flex flex-col items-center border rounded-md p-4 bg-gray-50">
                            <img
                                [src]="highlight.image"
                                alt="{{ highlight.step }}"
                                class="w-32 h-32 object-cover rounded-md mb-2" />
                            <p>
                                <strong>{{ highlight.step }}</strong>
                            </p>
                            <p>{{ highlight.description }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations -->
            <div class="mt-6 px-6">
                <div class="text-center font-bold bg-gray-100 py-2 border-b">RECOMENDACIONES</div>
                <ul class="bg-gray-50 py-6 px-4 rounded-md border mt-2 list-disc list-inside">
                    <li *ngFor="let recommendation of recommendations">{{ recommendation }}</li>
                </ul>
            </div>

            <!-- Footer with Digital Signature -->
            <div class="mt-8 px-6 text-center">
                <div class="flex justify-between items-center mt-6">
                    <!-- Digital Signature -->
                    <div>
                        <p class="text-sm font-bold">FIRMA DIGITAL DEL DOCTOR:</p>
                        <div
                            class="w-40 h-24 border border-dashed rounded-md flex items-center justify-center bg-gray-50 mt-2">
                            <img
                                *ngIf="doctor.signature"
                                [src]="doctor.signature"
                                alt="Firma Digital"
                                class="max-h-full max-w-full object-contain" />
                            <span *ngIf="!doctor.signature" class="text-gray-400 text-sm">
                                No hay firma
                            </span>
                        </div>
                    </div>

                    <!-- Doctor Information -->
                    <div>
                        <p><strong>Especialidad:</strong> {{ doctor.specialty }}</p>
                        <p><strong>DOCTOR:</strong> {{ doctor.name }}</p>
                        <p><strong>Fecha de impresión:</strong> {{ printDate }}</p>
                    </div>
                </div>

                <!-- Print Button -->
                <button
                    class="bg-teal-700 text-white py-2 px-6 rounded-md mt-4"
                    (click)="printReport()">
                    Imprimir Ficha
                </button>
            </div>

            <!-- Footer Separator -->
            <div class="mt-4 bg-gray-200 h-2"></div>
        </div>
    </div>
</div>
